<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mozip.domain.member.AuthRepository">
    <insert id="joinMember">
        INSERT INTO MEMBER(ID, EMAIL, PASSWORD, USERNAME, PHONE, CAREER, INFO, GITHUB_LINK, PROFILE_IMAGE_URL, POSITION,
                           IS_MODIFY, CREATED_AT)
        VALUES (MEMBER_SEQ.NEXTVAL, #{email}, #{password}, #{username}, #{phone}, 0, '수정필요!', '수정필요!', '수정필요!', 0, 0,
                TO_CHAR(SYSDATE, 'YYYY-MM-DD HH:MI:SS'))
    </insert>

    <select id="findLoginMember" resultType="com.mozip.domain.member.Member">
        SELECT *
        FROM MEMBER
        WHERE EMAIL = #{email}
    </select>

    <select id="findByEmail" resultType="java.lang.String">
        SELECT EMAIL
        FROM MEMBER
        WHERE EMAIL = #{email}
    </select>

    <select id="findById" resultType="java.lang.String">
        SELECT EMAIL
        FROM MEMBER
        WHERE ID = #{memberId}
    </select>

    <update id="updateProfileImg">
        UPDATE MEMBER
        SET PROFILE_IMAGE_URL=#{imageDir}
        WHERE ID = #{memberId}
    </update>


    <select id="findMemberEmail" parameterType="com.mozip.dto.req.FindEmailDto" resultType="java.lang.String">
        SELECT EMAIL
        FROM MEMBER
        WHERE USERNAME = #{username} AND PHONE = #{phone}
    </select>

</mapper>