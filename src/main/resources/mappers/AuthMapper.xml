<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mozip.domain.member.AuthRepository">
    <!--회원가입-->
    <insert id="joinMember">
        INSERT INTO MEMBER (EMAIL, PASSWORD, USERNAME, PHONE, CAREER, INFO, GITHUB_LINK, PROFILE_IMAGE_URL, POSITION,
                            ROLE,
                            IS_MODIFY, CREATED_AT)
        VALUES (#{dto.email}, #{dto.password}, #{dto.username}, #{dto.phone}, 0, '수정필요!', '수정필요!',
                'profile_sample.png', 0, #{role}, 0, NOW())
    </insert>

    <select id="findMember" resultType="com.mozip.domain.member.Member">
        SELECT *
        FROM MEMBER
        WHERE EMAIL = #{email}
    </select>

    <select id="findByEmail" resultType="java.lang.String">
        SELECT EMAIL
        FROM MEMBER
        WHERE EMAIL = #{email}
    </select>

    <select id="findById" resultType="java.lang.String">
        SELECT EMAIL
        FROM MEMBER
        WHERE ID = #{memberId}
    </select>
    <!--프로필 이미지-->
    <update id="updateProfileImg">
        UPDATE MEMBER
        SET PROFILE_IMAGE_URL=#{imageDir}
        WHERE ID = #{memberId}
    </update>

    <!-- 유저네임 찾기 -->
    <select id="findToUsername" resultType="java.lang.String">
        SELECT USERNAME
        FROM MEMBER
        WHERE ID = #{memberId}
    </select>

    <!-- 프로젝트 멤버 추가 -->
    <insert id="projectJoin">
        INSERT INTO PROJECT_MEMBER (PROJECT_ID, MEMBER_ID)
        VALUES (#{projectId}, #{memberId})
    </insert>
    <!--이메일 찾기-->
    <select id="findMemberEmail" parameterType="com.mozip.dto.req.project.FindEmailDto" resultType="java.lang.String">
        SELECT EMAIL
        FROM MEMBER
        WHERE USERNAME = #{username} AND PHONE = #{phone}
    </select>

</mapper>
